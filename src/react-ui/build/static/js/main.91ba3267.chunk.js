(this["webpackJsonpalive-flowers"]=this["webpackJsonpalive-flowers"]||[]).push([[0],{151:function(t,e){},152:function(t,e){},161:function(t,e,c){},162:function(t,e,c){},163:function(t,e,c){},164:function(t,e,c){},166:function(t,e,c){},167:function(t,e,c){},168:function(t,e,c){},169:function(t,e,c){"use strict";c.r(e);var n=c(1),r=c(57),i=c.n(r),s=c(22),o=(c(161),c(13)),a=(c(162),"flowers/ESP_LED/set"),l=60,u={"rgb(255, 100, 0)":{r:255,g:100,b:0},"rgb(255, 20, 147)":{r:255,g:20,b:147},"rgb(200, 0, 255)":{r:200,g:0,b:255},"rgb(0, 255, 255)":{r:0,g:255,b:255},"rgb(0, 225, 0)":{r:0,g:225,b:0},"rgb(255, 255, 0)":{r:255,g:255,b:0}},b={"rgb(255, 100, 0)":"rgb(251, 206, 91)","rgb(255, 20, 147)":"rgb(248, 184, 211)","rgb(200, 0, 255)":"rgb(186, 111, 168)","rgb(0, 255, 255)":"rgb(162, 218, 219)","rgb(0, 225, 0)":"rgb(213, 226, 116)","rgb(255, 255, 0)":"rgb(255, 248, 161)"},g="rgb(255, 255, 255)",j=parseInt(localStorage.getItem("user_id"));j||(j=Math.floor(1e5*Math.random()),localStorage.setItem("user_id",j));var m=c.p+"static/media/logo.ea23c954.svg",f=function(t,e,c,n){return'{"state": "ON","brightness": 255,"color": '.concat(JSON.stringify(t),',"transition": 0,"user_id": ').concat(JSON.stringify(e),',"endSes_d": ').concat(c,',"idle_d": ').concat(n,"}")},d=(c(163),c(164),c(0)),O=function(t){var e=t.timeLeft,c=t.timerClass,n=void 0===c?"":c;return e<=0&&(e=l),Object(d.jsx)("section",{className:n?"timer ".concat(n):"timer",children:e})},v=(c(166),c.p+"static/media/main-bg.f8215fc8.jpg"),p=c.p+"static/media/main-bg-blue.f8e708b8.jpg",h=c.p+"static/media/main-bg-green.d9f1c009.jpg",x={"rgb(255, 255, 255)":v,"rgb(251, 206, 91)":c.p+"static/media/main-bg-orange.087156be.jpg","rgb(248, 184, 211)":c.p+"static/media/main-bg-pink.7e61175a.jpg","rgb(186, 111, 168)":c.p+"static/media/main-bg-violet.0e479edf.jpg","rgb(162, 218, 219)":p,"rgb(213, 226, 116)":h,"rgb(255, 248, 161)":c.p+"static/media/main-bg-yellow.94fa6b70.jpg"},_=function(t){var e=t.activeColor,c=e||g;return Object(d.jsxs)("section",{className:"flowers-field",children:[Object.keys(x).map((function(t){return Object(d.jsx)("img",{alt:"Alive Flowers are watching you",className:t===c?"flowers active":"flowers",src:x[t]},t)})),Object(d.jsx)("p",{className:"flowers-info",children:"\u041e\u0431\u0435\u0440\u0438 \u043c\u0435\u043d\u0456 \u0432\u0456\u0434\u0442\u0456\u043d\u043e\u043a \u0442\u0430 \u0437\u0430\u0444\u0430\u0440\u0431\u0443\u0439 \u043a\u0432\u0456\u0442\u043a\u0438."})]})},k=function(t){var e=t.gameTime,c=t.activeColor,n=t.setActiveColor,r=t.mqtt;return Object(d.jsxs)("section",{className:"controls-wrap",children:[Object(d.jsx)(_,{activeColor:b[c]}),Object(d.jsxs)("section",{className:"controls",children:[Object(d.jsx)("ul",{children:Object.keys(u).map((function(t,e){return Object(d.jsx)("li",{className:c===t?"button-".concat(e+1," active"):"button-".concat(e+1),onClick:function(){return function(t){r.publish(a,f(u[t],j,l,30)),n(t)}(t)},style:{background:b[t]}},t)}))}),Object(d.jsx)(O,{timerClass:"controls-timer",timeLeft:e})]})]})},w=(c(167),c.p+"static/media/lotus-aqua.e0d01c2a.svg"),C=c.p+"static/media/lotus-green.92564941.svg",N=c.p+"static/media/lotus-orange.17c89be0.svg",I=c.p+"static/media/lotus-pink.87b2eeeb.svg",S=c.p+"static/media/lotus-violet.8a14d3ad.svg",y=c.p+"static/media/lotus-yellow.dc894035.svg",T=function(){return Object(d.jsxs)("section",{className:"locked-screen",children:[Object(d.jsx)("p",{className:"locked-info",children:"\u0417\u0430\u0447\u0435\u043a\u0430\u0439\u0442\u0435,"}),Object(d.jsx)("p",{children:"\u0437\u0430\u0440\u0430\u0437 \u0443\u043f\u0440\u0430\u0432\u043bi\u043d\u043d\u044f"}),Object(d.jsx)("p",{children:"\u043a\u0438\u043c\u043e\u0441\u044c \u0437\u0430\u0439\u043d\u044f\u0442\u0435"}),Object(d.jsxs)("div",{className:"locked-img",children:[Object(d.jsx)("img",{className:"lotus-1",src:w,alt:"lotusAqua"}),Object(d.jsx)("img",{className:"lotus-2",src:C,alt:"lotusGreen"}),Object(d.jsx)("img",{className:"lotus-3",src:N,alt:"lotusOrange"}),Object(d.jsx)("img",{className:"lotus-4",src:I,alt:"lotusPink"}),Object(d.jsx)("img",{className:"lotus-5",src:S,alt:"lotusViolet"}),Object(d.jsx)("img",{className:"lotus-6",src:y,alt:"lotusYellow"})]})]})},D=(c(168),c.p+"static/media/timer-bg.eda28634.svg"),q=function(t){var e=t.mqtt,c=function(t){var c=function(t,e,c,n,r){return'{"state": "ON","brightness": 255,"color": '.concat(JSON.stringify(t),',"transition": 0,"user_id": ').concat(JSON.stringify(e),',"endSes_d": ').concat(c,',"idle_d": ').concat(n,',"effect":').concat(r,"}")}('{ "r": 99, "g": 0, "b": 0 }',j,l,30,t);console.log(t,c),e.publish(a,c)},r=function(t,c,n){var r=f('{ "r": '.concat(t,', "g": ').concat(c,', "b": ').concat(n," }"),j,l,30);console.log(r),e.publish(a,r)},i=function(){var t=(new Date).getTime(),e=parseInt(localStorage.getItem("gm_active_till_t"));return"user"+j+": "+(e?Math.round((e-t)/1e3):"?")},s=Object(n.useState)(i()),u=Object(o.a)(s,2),b=u[0],g=u[1];return Object(n.useEffect)((function(){var t=setInterval((function(){g(i())}),1e3);return function(){return clearInterval(t)}})),Object(d.jsxs)("section",{className:"locked-screen",children:[Object(d.jsx)("p",{className:"locked-info"}),Object(d.jsx)("p",{}),Object(d.jsx)("button",{onClick:function(){return c("rnd")},children:"rnd"}),Object(d.jsx)("button",{onClick:function(){return c("fade_all_but_1")},children:"fade_all_but_1"}),Object(d.jsx)("button",{onClick:function(){return c("blink_1")},children:"blink_1 (TODO)"}),Object(d.jsx)("button",{onClick:function(){return c("epileptogen")},children:"epileptogen (TODO)"}),Object(d.jsx)("button",{onClick:function(){return r(255,0,0)},children:"R"}),Object(d.jsx)("button",{onClick:function(){return r(0,255,0)},children:"G"}),Object(d.jsx)("button",{onClick:function(){return r(0,0,255)},children:"B"}),Object(d.jsx)("button",{onClick:function(){return r(0,0,0)},children:"0"}),Object(d.jsx)("button",{onClick:function(){return r(255,255,255)},children:"255,255,255"}),Object(d.jsx)("button",{class:"btnB",onClick:function(){localStorage.setItem("gm_active_till_t",Math.floor((new Date).getTime()+2e4))},children:"set timer 20"}),Object(d.jsx)("button",{class:"btnB",onClick:function(){localStorage.removeItem("gm_active_till_t")},children:"clear timer"}),Object(d.jsx)("button",{class:"btnB",onClick:function(){localStorage.removeItem("gm_active_till_t"),localStorage.removeItem("user_id"),user_id=null},children:"remove user"}),Object(d.jsxs)("div",{className:"timer-wrapper",children:[Object(d.jsx)("img",{src:D,alt:"timer",className:"timer-bg"}),Object(d.jsx)(O,{timeLeft:b})]})]})},E=Object(s.subscribe)({topic:"flowers/ESP_LED"})((function(t){var e=t.activeColor,c=t.setActiveColor,r=t.data,i=t.mqtt,s=Object(n.useState)(null),a=Object(o.a)(s,2),u=a[0],b=a[1];Object(n.useEffect)((function(){if(r&&r.length){var t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).reduce((function(e,c){return"b"===c?"".concat(e).concat(t[c],")"):"".concat(e).concat(t[c],", ")}),"rgb(")}(r[0].color);c(t)}return null}),[r,c]),Object(n.useEffect)((function(){return g()})),Object(n.useEffect)((function(){var t=setInterval((function(){var t=parseInt(localStorage.getItem("gm_active_till_t")),e=t&&t-(new Date).getTime()>0?Math.floor((t-(new Date).getTime())/1e3):0;b(e)}),1e3);return function(){return clearInterval(t)}}),[u]);var g=function(){var t=(new Date).getTime(),e=parseInt(localStorage.getItem("gm_active_till_t"));e&&t<e&&b(Math.round((e-t)/1e3))},m=(new Date).getTime(),f=parseInt(localStorage.getItem("gm_active_till_t")),O=!1;f&&(m<f+12e5?O=!0:(localStorage.removeItem("gm_active_till_t"),f=null));var v=function(){window.location.href="https://tsum.ua/"};if(r[0]){var p=parseInt(r[0].user_active);if(0===p)O&&v();else if(p)if(p===j)f||(f=Math.floor(m+6e4),localStorage.setItem("gm_active_till_t",f));else{if(!O)return Object(d.jsx)(T,{});v()}}else{if(window.location.search.includes("testesp"))return Object(d.jsx)(q,{mqtt:i});if(!f)return Object(d.jsx)(T,{});if(m>f&&m<f+l){if(!O)return Object(d.jsx)(T,{});v()}}return window.location.search.includes("testesp")?Object(d.jsx)(q,{mqtt:i}):Object(d.jsx)(k,{mqtt:i,gameTime:u,activeColor:e,setActiveColor:c})})),L=function(){var t=Object(n.useState)(g),e=Object(o.a)(t,2),c=e[0],r=e[1];return Object(d.jsxs)("section",{className:"game",children:[Object(d.jsx)("a",{href:"https://tsum.ua/",className:"logo",target:"_blank",rel:"noreferrer",children:Object(d.jsx)("img",{src:m,alt:"\u0426\u0423\u041c \u041a\u0438\u0435\u0432"})}),Object(d.jsx)(E,{activeColor:c,setActiveColor:r})]})},M=function(t){t&&t instanceof Function&&c.e(3).then(c.bind(null,170)).then((function(e){var c=e.getCLS,n=e.getFID,r=e.getFCP,i=e.getLCP,s=e.getTTFB;c(t),n(t),r(t),i(t),s(t)}))};i.a.render(Object(d.jsx)(s.Connector,{mqttProps:"ws://10.42.0.1:9001",children:Object(d.jsx)(L,{})}),document.getElementById("root")),M()},69:function(t,e){},71:function(t,e){}},[[169,1,2]]]);
//# sourceMappingURL=main.91ba3267.chunk.js.map