{"version":3,"sources":["const.js","assets/logo.svg","components/CountDownTimer/CountDownTimer.jsx","assets/main-bg.jpg","assets/main-bg-blue.jpg","assets/main-bg-green.jpg","components/Flowers/Flowers.jsx","assets/main-bg-orange.jpg","assets/main-bg-pink.jpg","assets/main-bg-violet.jpg","assets/main-bg-yellow.jpg","components/Controls/Controls.jsx","utils.js","assets/lotus-aqua.svg","assets/lotus-green.svg","assets/lotus-orange.svg","assets/lotus-pink.svg","assets/lotus-violet.svg","assets/lotus-yellow.svg","components/LockedScreen/LockedScreen.jsx","components/Game/Game.jsx","components/App/App.jsx","reportWebVitals.js","index.js"],"names":["GAME_TIME_PLAY","COLORS","FAKE_COLORS","COLOR_DEFAULT","CountDownTimer","timeLeft","timerClass","className","flowers","backgroundImage","backgroundImageBlue","backgroundImageGreen","Flowers","activeColor","activeFlower","Object","keys","map","flower","alt","src","Controls","gameTime","setActiveColor","mqtt","user_id","localStorage","getItem","Math","floor","random","setItem","onSelectColor","color","publish","endSes_d","idle_d","JSON","stringify","generateMessage","i","onClick","style","background","LockedScreen","lotusAqua","lotusGreen","lotusOrange","lotusPink","lotusViolet","lotusYellow","LockedScreen0","subscribe","topic","data","useState","setGameTime","useEffect","length","reduce","rgbStr","col","rgbStringify","setGameTimer","timer","setInterval","gm_active_till_t","parseInt","countdown","Date","getTime","clearInterval","date","time","round","now_t","removeItem","user_active","active_last_t","App","href","target","rel","logo","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","mqttProps","process","document","getElementById"],"mappings":"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","file":"static/js/main.8385276a.chunk.js","sourcesContent":["export const MQTT_TOPIC_SUBSCRIBE = 'flowers/ESP_LED';\nexport const MQTT_TOPIC_PUBLISH = 'flowers/ESP_LED/set';\n\n//export const GAME_TIME_PLAY = Number.parseInt(process.env.REACT_APP_GAME_TIME_PLAY) || 60; //send MQTT as 'endSes_d'\nexport const GAME_TIME_PLAY = 60; //send MQTT as 'endSes_d'\nexport const idle_d = 30; //send MQTT as 'idle_d'\n\nexport const COLORS = {\n  'rgb(255, 100, 0)': { \"r\": 255, \"g\": 100, \"b\": 0 }, // orange\n  'rgb(255, 20, 147)': { \"r\": 255, \"g\": 20, \"b\": 147 }, // pink\n  'rgb(200, 0, 255)': { \"r\": 200, \"g\": 0, \"b\": 255 }, // violet\n  'rgb(0, 255, 255)': { \"r\": 0, \"g\": 255, \"b\": 255 }, // aqua\n  'rgb(0, 225, 0)': { \"r\": 0, \"g\": 225, \"b\": 0 }, // green\n  'rgb(255, 255, 0)': { \"r\": 255, \"g\": 255, \"b\": 0 } // yellow\n};\n\nexport const FAKE_COLORS = {\n  'rgb(255, 100, 0)': 'rgb(251, 206, 91)',\n  'rgb(255, 20, 147)': 'rgb(248, 184, 211)',\n  'rgb(200, 0, 255)': 'rgb(186, 111, 168)',\n  'rgb(0, 255, 255)': 'rgb(162, 218, 219)',\n  'rgb(0, 225, 0)': 'rgb(213, 226, 116)',\n  'rgb(255, 255, 0)': 'rgb(255, 248, 161)'\n}\n\nexport const COLOR_DEFAULT = 'rgb(255, 255, 255)';\n","export default __webpack_public_path__ + \"static/media/logo.ea23c954.svg\";","import React from 'react';\nimport {\n  GAME_TIME_PLAY\n} from '../../const';\n\nimport './styles.css';\n//import { calculateTimeLeft } from '../../utils';\n\nconst CountDownTimer = ({ timeLeft, timerClass = '' }) => {\n\t//sec only\n\tif(timeLeft<=0) timeLeft=GAME_TIME_PLAY;\n  return (\n    <section className={timerClass ? `timer ${timerClass}` : 'timer'}>\n      {timeLeft}\n    </section>\n  )\n  /* //min:sec\n  const [minutes, seconds] = calculateTimeLeft(timeLeft);\n\n  return (\n    <section className={timerClass ? `timer ${timerClass}` : 'timer'}>\n      {minutes} : {seconds}\n    </section>\n  )\n  */\n};\n\nexport default CountDownTimer;\n","export default __webpack_public_path__ + \"static/media/main-bg.f8215fc8.jpg\";","export default __webpack_public_path__ + \"static/media/main-bg-blue.f8e708b8.jpg\";","export default __webpack_public_path__ + \"static/media/main-bg-green.d9f1c009.jpg\";","import React from 'react';\n\nimport './styles.css';\nimport backgroundImage from '../../assets/main-bg.jpg';\nimport backgroundImageBlue from '../../assets/main-bg-blue.jpg';\nimport backgroundImageGreen from '../../assets/main-bg-green.jpg';\nimport backgroundImageOrange from '../../assets/main-bg-orange.jpg';\nimport backgroundImagePink from '../../assets/main-bg-pink.jpg';\nimport backgroundImageViolet from '../../assets/main-bg-violet.jpg';\nimport backgroundImageYellow from '../../assets/main-bg-yellow.jpg';\nimport { COLOR_DEFAULT } from '../../const';\n\nconst flowers = {\n  'rgb(255, 255, 255)': backgroundImage,\n  'rgb(251, 206, 91)': backgroundImageOrange,\n  'rgb(248, 184, 211)': backgroundImagePink,\n  'rgb(186, 111, 168)': backgroundImageViolet,\n  'rgb(162, 218, 219)': backgroundImageBlue,\n  'rgb(213, 226, 116)': backgroundImageGreen,\n  'rgb(255, 248, 161)': backgroundImageYellow\n}\n\nconst Flowers = ({ activeColor }) => {\n  const activeFlower = activeColor ? activeColor : COLOR_DEFAULT;\n\n  return (\n    <section className='flowers-field'>\n      {Object.keys(flowers).map(flower => (\n        <img\n          key={flower}\n          alt=\"Alive Flowers are watching you\"\n          className={flower === activeFlower ? `flowers active` : 'flowers'}\n          src={flowers[flower]}\n         />\n      ))}\n      <p className='flowers-info'>Обери мені відтінок та зафарбуй квітки.</p>\n    </section>\n  )\n}\n\nexport default Flowers;\n","export default __webpack_public_path__ + \"static/media/main-bg-orange.087156be.jpg\";","export default __webpack_public_path__ + \"static/media/main-bg-pink.7e61175a.jpg\";","export default __webpack_public_path__ + \"static/media/main-bg-violet.0e479edf.jpg\";","export default __webpack_public_path__ + \"static/media/main-bg-yellow.94fa6b70.jpg\";","import React from 'react';\n\nimport './styles.css';\nimport { COLORS, FAKE_COLORS, MQTT_TOPIC_PUBLISH, GAME_TIME_PLAY, idle_d } from '../../const';\nimport { generateMessage } from '../../utils';\nimport CountDownTimer from '../CountDownTimer';\nimport Flowers from '../Flowers';\n\nconst Controls = ({ gameTime, activeColor, setActiveColor, mqtt }) => {\n//TODO move to root\nvar user_id = localStorage.getItem('user_id');\nif(!user_id)\n{\n\tuser_id=Math.floor(Math.random()*100000);\n\tlocalStorage.setItem('user_id',user_id);\n}\n\n  const onSelectColor = color => {\n\t  \n    mqtt.publish(\n      MQTT_TOPIC_PUBLISH,\n      generateMessage(COLORS[color], user_id, GAME_TIME_PLAY, idle_d)\n    );\n    setActiveColor(color);\n  };\n\n  return (\n    <section className='controls-wrap'>\n      <Flowers activeColor={FAKE_COLORS[activeColor]} />\n      <section className='controls'>\n        <ul>\n          {Object.keys(COLORS).map((color, i) => (\n            <li\n              key={color}\n              className={activeColor === color ? `button-${i+1} active` : `button-${i+1}`}\n              onClick={() => onSelectColor(color)}\n              style={{ background: FAKE_COLORS[color] }}\n            />\n          ))}\n        </ul>\n        <CountDownTimer\n          timerClass='controls-timer'\n          timeLeft={gameTime}\n        />\n      </section>\n    </section>\n  );\n};\n\nexport default Controls;\n","// import {\n  // GAME_TIME_PLAY\n// } from '../src/const';\n\nexport const generateMessage = (color,user_id, endSes_d, idle_d) => (\n  `{\"state\": \"ON\",\"brightness\": 255,\"color\": ${JSON.stringify(color)},\"transition\": 0,\"user_id\": ${JSON.stringify(user_id)},\"endSes_d\": ${endSes_d},\"idle_d\": ${idle_d}}`\n);\n\nexport const rgbStringify = (color = {}) => Object.keys(color).reduce((rgbStr, col) => (col === 'b'\n    ? `${rgbStr}${color[col]})`\n    : `${rgbStr}${color[col]}, `\n  ), 'rgb(');\n\nexport const calculateTimeLeft = (time) => {\n  const minutes = Math.floor((time / 60) % 60);\n  const seconds = Math.floor(time % 60);\n  if(time<=0) return ['','']; //blank w dots\n  //if(time<=0) return ['0',GAME_TIME_PLAY];\n  return [\n    `0${minutes}`,\n    seconds < 10 ? `0${seconds}` : seconds\n  ]\n};\n","export default __webpack_public_path__ + \"static/media/lotus-aqua.e0d01c2a.svg\";","export default __webpack_public_path__ + \"static/media/lotus-green.92564941.svg\";","export default __webpack_public_path__ + \"static/media/lotus-orange.17c89be0.svg\";","export default __webpack_public_path__ + \"static/media/lotus-pink.87b2eeeb.svg\";","export default __webpack_public_path__ + \"static/media/lotus-violet.8a14d3ad.svg\";","export default __webpack_public_path__ + \"static/media/lotus-yellow.dc894035.svg\";","import React from 'react';\n\nimport './styles.css';\nimport lotusAqua from '../../assets/lotus-aqua.svg';\nimport lotusGreen from '../../assets/lotus-green.svg'\nimport lotusOrange from '../../assets/lotus-orange.svg'\nimport lotusPink from '../../assets/lotus-pink.svg'\nimport lotusViolet from '../../assets/lotus-violet.svg'\nimport lotusYellow from '../../assets/lotus-yellow.svg'\n// import timerBg from '../../assets/timer-bg.svg';\n// import CountDownTimer from '../CountDownTimer';\n\nexport const LockedScreen = (/*{ appTime }*/) => (\n  <section className='locked-screen'>\n    <p className='locked-info'>Дякую за твій дотик!</p>\n    <p>Ти справжній митець.</p>\n    <p>Спробуй ще через пару хвилини.</p>\n    <div className='locked-img'>\n      <img className='lotus-1' src={lotusAqua} alt=\"lotusAqua\" />\n      <img className='lotus-2' src={lotusGreen} alt=\"lotusGreen\" />\n      <img className='lotus-3' src={lotusOrange} alt=\"lotusOrange\" />\n      <img className='lotus-4' src={lotusPink} alt=\"lotusPink\" />\n      <img className='lotus-5' src={lotusViolet} alt=\"lotusViolet\" />\n      <img className='lotus-6' src={lotusYellow} alt=\"lotusYellow\" />\n    </div>\n    {/* <div className='timer-wrapper'>\n      <img src={timerBg} alt='timer' className='timer-bg' />\n      <CountDownTimer timeLeft={appTime} />\n    </div> */}\n  </section>\n);\n\nexport const LockedScreen0 = (/*{ appTime }*/) => (\n  <section className='locked-screen'>\n    <p className='locked-info'>Зачекайте,</p>\n    <p>зараз управлiння</p>\n    <p>кимось зайняте</p>\n    <div className='locked-img'>\n      <img className='lotus-1' src={lotusAqua} alt=\"lotusAqua\" />\n      <img className='lotus-2' src={lotusGreen} alt=\"lotusGreen\" />\n      <img className='lotus-3' src={lotusOrange} alt=\"lotusOrange\" />\n      <img className='lotus-4' src={lotusPink} alt=\"lotusPink\" />\n      <img className='lotus-5' src={lotusViolet} alt=\"lotusViolet\" />\n      <img className='lotus-6' src={lotusYellow} alt=\"lotusYellow\" />\n    </div>\n    {/* <div className='timer-wrapper'>\n      <img src={timerBg} alt='timer' className='timer-bg' />\n      <CountDownTimer timeLeft={appTime} />\n    </div> */}\n  </section>\n);\n\n\n\n\n\n","import React, { useState, useEffect } from 'react';\nimport { subscribe } from 'mqtt-react';\n\nimport {\n  MQTT_TOPIC_SUBSCRIBE,\n  GAME_TIME_PLAY\n} from '../../const';\nimport { rgbStringify } from '../../utils';\n//import { setTimer } from '../../api';\nimport Controls from '../Controls';\nimport {LockedScreen, LockedScreen0} from '../LockedScreen';\n\n\nconst Game = ({ activeColor, setActiveColor, data, mqtt }) => {\n  const [gameTime, setGameTime] = useState(null);\n\n  //const game = localStorage.getItem('gameActive');\n  //const gameState = game ? JSON.parse(game) : true;\n  //const [gameActive, setGameActive] = useState(gameState);\n  \n  useEffect(() => {\n    if (data && data.length) {\n      const color = rgbStringify(data[0].color);\n      setActiveColor(color);\n    }\n    return null;\n  }, [data,setActiveColor]);\n\n  //useEffect(() => setGameTimer(), [gameActive]);\n  useEffect(() => setGameTimer());\n\n  useEffect(() => {\n    // if (gameTime === 0) {\n      // localStorage.setItem('gameActive', !gameActive);\n    // };\n//const timer = gameTime > 0 && setInterval(() => setGameTime(gameTime - 1), 1000);\n//console.log(gameTime);\n    const timer =  setInterval(() => {\n\t\tlet gm_active_till_t = parseInt(localStorage.getItem('gm_active_till_t'));\n\t\tlet countdown=(gm_active_till_t&&(gm_active_till_t-new Date().getTime())>0)?\tMath.floor((gm_active_till_t-new Date().getTime())/1000) :0;\n\t\t//console.log(countdown);\n\t\t\n\t\tsetGameTime(countdown)\n\t\t}, 1000);\n    return () => clearInterval(timer);\n  }, [gameTime]);\n\n  const setGameTimer = () => {\n    //var activeGameTime = localStorage.getItem('activeTime');\n    //const isGameActive = JSON.parse(localStorage.getItem('gameActive'));\n\n    const date = new Date();\n    const time = date?.getTime();\n    //const timeToPlay = time + (GAME_TIME_PLAY * 1000);\n\t\n\t//let gm_active_till_t = localStorage.getItem('gm_active_till_t');\n\t//TODO unlock timer if time >gm_active_till_t  but < gm_active_till_t+GAME_TIME_PLAY\n\t//\n\t\n\t/*\n    if (!activeGameTime) {\n      localStorage.setItem('gameActive', true);\n      //setTimer();\n      setGameTime(GAME_TIME_PLAY);\n      localStorage.setItem('activeTime', timeToPlay);\n      return;\n    }\n\t*/\n\n\t//activeGameTime=parseInt(activeGameTime);\n\t\n\tlet gm_active_till_t = parseInt(localStorage.getItem('gm_active_till_t'));\n//console.log(time, timeToPlay, activeGameTime, isGameActive, gm_active_till_t);\n\n    if (gm_active_till_t && (time < gm_active_till_t)) {\n      setGameTime(Math.round((gm_active_till_t - time) / 1000));\n      return;\n    };\n    // if ((time < activeGameTime) && isGameActive) {\n      // setGameTime(Math.round((activeGameTime - time) / 1000));\n      // return;\n    // };\n/*\n    if (time > activeGameTime) {\n      localStorage.setItem('gameActive', true);\n      //setTimer();\n      setGameActive(true);\n      setGameTime(GAME_TIME_PLAY);\n      localStorage.setItem('activeTime', timeToPlay);\n      return;\n    }*/\n  };\n\n\t\t\t\t//test\n\t\t  \t  \t//return <CountDownTimer />\n\t\t\t\t//return <LockedScreen0 />\n\t//TODO move to root\n\tvar user_id = localStorage.getItem('user_id');\n\t//var bFirtsRun=false;\n\tif(!user_id)\n\t{\n\t\t//bFirtsRun=true;\n\t\tuser_id=Math.floor(Math.random()*100000);\n\t\tlocalStorage.setItem('user_id',user_id);\n\t}\n\telse user_id=parseInt(user_id);\n\tlet now_t=new Date().getTime();\n\tif(data[0])\n\t{\n\t\t{\n\t\tlet gm_active_till_t = parseInt(localStorage.getItem('gm_active_till_t'));\n\t\tif(gm_active_till_t-now_t <-GAME_TIME_PLAY)\n\t\t{ //TODO refactoring\n\t\t\tlocalStorage.removeItem('gm_active_till_t');\n\t\t\tgm_active_till_t=null;\n\t\t}\n\t\t\n\t\t//console.log(data[0], data[0].user_active, user_id, gm_active_till_t-now_t);//, data[0].user_active, user_id, parseInt(data[0].user_active)==user_id\n\t\t\n\t\t}\n\t\tvar user_active=parseInt(data[0].user_active);\n\t\t\n\t\tif (user_active===0)\n\t\t{\n\t\t\tlet gm_active_till_t = parseInt(localStorage.getItem('gm_active_till_t'));\n\t\t\tif(gm_active_till_t&&now_t<gm_active_till_t+GAME_TIME_PLAY) \n\t\t\t{//some time to other people can react on game open\n\t\t//TODO can be smaller than GAME_TIME_PLAY, if no other active users appear\n\t\t//TODO2 do not off game if nobody else connected\n\t\t\t\treturn <LockedScreen />\n\t\t\t}\n\t\t}\n\t\telse\n\t\tif (user_active)\n\t\t{\n\t\t\tif (user_active===user_id)\n\t\t\t{ //this user is active\n\t\t\t\tlet active_last_t=localStorage.getItem('active_last_t');\n\t\t\t\t\n\t\t\t\tif(!active_last_t || parseInt(active_last_t)<now_t-60*1000)\tlocalStorage.setItem('active_last_t', now_t); //show LockedScreen or LockedScreen0\n\t\t\t\tlet gm_active_till_t = localStorage.getItem('gm_active_till_t');\n\t\t\t\tif(!gm_active_till_t) //at start of active\n\t\t\t\t{\n\t\t\t\t\tlocalStorage.setItem('gm_active_till_t',Math.floor(now_t+GAME_TIME_PLAY*1000));\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocalStorage.removeItem('gm_active_till_t');\n\t\t\t\treturn <LockedScreen />\n\t\t\t}\n\n\t\t}\n\t}\n\telse\n\t{\n\t\tlet gm_active_till_t = localStorage.getItem('gm_active_till_t');\n\t\tif(gm_active_till_t)\n\t\t{\n\t\t\tgm_active_till_t=parseInt(gm_active_till_t);\n\t\t\tif(now_t>gm_active_till_t && now_t<gm_active_till_t+GAME_TIME_PLAY)\n\t\t\t{\n\t\t\t\tlet active_last_t=localStorage.getItem('active_last_t');\n\t\t\t\t\n\t\t\t\tif(!active_last_t || parseInt(active_last_t)<now_t-60*60*1000)\n\t\t\t\t\treturn <LockedScreen0 />\n\t\t\t\telse\n\t\t\t\t\t//last visit recently\n\t\t\t\t\treturn <LockedScreen />\n\t\t\t}\n\t\t}\n\t\t\n\t\t//if (!gameTime) return <LockedScreen />\n\t}\n\n  return (\n    <Controls\n      mqtt={mqtt}\n      gameTime={gameTime}\n      activeColor={activeColor}\n      setActiveColor={setActiveColor}\n    />\n  );\n};\n\nexport default subscribe({ topic: MQTT_TOPIC_SUBSCRIBE })(Game);\n","import React, { useState } from 'react';\n\nimport './styles.css';\nimport { COLOR_DEFAULT } from '../../const';\nimport logo from '../../assets/logo.svg';\nimport Game from '../Game';\n\nconst App = () => {\n  const [activeColor, setActiveColor] = useState(COLOR_DEFAULT);\n\n  return (\n    <section className='game'>\n      <a href='https://tsum.ua/' className='logo' target='_blank' rel=\"noreferrer\">\n        <img src={logo} alt='ЦУМ Киев'/>\n      </a>\n      <Game activeColor={activeColor} setActiveColor={setActiveColor} />\n    </section>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Connector } from 'mqtt-react';\n\nimport './index.css';\nimport App from './components/App';\n\nimport reportWebVitals from './reportWebVitals';\n\nconst mqttBrokerUrl = process.env.REACT_APP_MQTT_BROKER_URL;\n\nReactDOM.render(\n  <Connector mqttProps={mqttBrokerUrl}>\n    <App />\n  </Connector>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}